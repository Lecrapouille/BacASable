# Mosquitto configuration for Broker 2 (Card 2)
# This broker bridges to Broker 1 to enable cross-card communication

# Listen on port 1884 for local connections
listener 1884

# Allow anonymous connections (for local development)
allow_anonymous true

# Bridge connection to Broker 1 (Card 1)
connection bridge_to_broker1
address localhost:1883

# Import sensors/card1 from Broker 1 with QoS 2
# Direction: in = from remote broker to local broker
topic sensors/card1 in 2

# Export sensors/all to Broker 1 with QoS 2
# Direction: out = from local broker to remote broker
topic sensors/all out 2

# Keep the bridge connection alive
keepalive_interval 60

# Reconnect automatically if connection is lost
restart_timeout 5

